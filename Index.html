<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üéì Fiches Employ√©s</title>
<style>
body {
  margin: 0;
  padding: 20px;
  font-family: "Segoe UI", Arial, sans-serif;
  background: #f5f7fb;
}

h1 {
  text-align: center;
  color: #2b3a67;
  font-size: 2rem;
  margin-bottom: 10px;
}

/* Menu de navigation */
#nav-menu {
  text-align: center;
  margin-bottom: 20px;
}
.nav-btn {
  display: inline-block;
  margin: 5px;
  padding: 10px 20px;
  background: #2b3a67;
  color: white;
  border-radius: 8px;
  cursor: pointer;
  font-weight: bold;
  text-decoration: none;
}
.nav-btn:hover {
  background: #4157a3;
}

#employee-list {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 20px;
}

.employee-card {
  background: white;
  border-radius: 15px;
  padding: 20px;
  width: 220px;
  box-shadow: 0 3px 10px rgba(0,0,0,0.1);
  text-align: center;
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.employee-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 6px 15px rgba(0,0,0,0.15);
}

.employee-name {
  font-weight: bold;
  font-size: 1.1rem;
  color: #1c2951;
}

.employee-grade {
  font-size: 0.9rem;
  color: #6b7280;
}

#employee-details {
  display: none;
  background: white;
  padding: 25px;
  border-radius: 15px;
  max-width: 700px;
  margin: 20px auto;
  box-shadow: 0 3px 10px rgba(0,0,0,0.1);
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 15px;
}

td {
  padding: 8px;
  border-bottom: 1px solid #eee;
}

td:first-child {
  font-weight: bold;
  color: #2b3a67;
  width: 35%;
}

.btn-nav {
  display: inline-block;
  margin: 10px 5px;
  background: #2b3a67;
  color: white;
  padding: 10px 20px;
  border-radius: 8px;
  cursor: pointer;
  font-weight: bold;
  text-decoration: none;
}

.btn-nav:hover {
  background: #4157a3;
}

@media (max-width: 600px) {
  .employee-card { width: 90%; }
  #employee-details { width: 90%; }
}
</style>
</head>
<body>

<h1>üéì Fiches Employ√©s</h1>

<!-- Menu de navigation -->
<div id="nav-menu"></div>

<div id="employee-list"></div>
<div id="employee-details"></div>

<script>
const SHEET_ID = "17ZntDHZ8olidnCM1pig311AcjawM4l6HoRxSYFP7KGw";
const API_KEY = "AIzaSyBtOfa8W5POpJ2KOZSKqxsC4CfZBkYG40E";
const SHEET_NAME = "Info Employ√©";

let currentIndex = 0;
let allEmployees = [];

// ‚öôÔ∏è Modifie ici tes cat√©gories
const categories = [
  { name: "Tous", filter: emp => true },
  { name: "Comptabilit√©", filter: emp => emp.grade.includes("Compta") },
  { name: "Marketing", filter: emp => emp.grade.includes("Marketing") },
  { name: "IT", filter: emp => emp.grade.includes("IT") }
];

async function loadEmployees() {
  const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${encodeURIComponent(SHEET_NAME)}?key=${API_KEY}`;
  const res = await fetch(url);
  const data = await res.json();

  if(!data.values || data.values.length === 0){
    document.getElementById("employee-list").innerHTML = "<p>Aucune donn√©e trouv√©e.</p>";
    return;
  }

  const rows = data.values.filter(r => r.some(cell => cell.trim() !== ""));
  const firstRowIsHeader = rows[0].some(v => v.match(/[A-Za-z]/));
  const dataRows = firstRowIsHeader ? rows.slice(1) : rows;

  allEmployees = dataRows.map(row => ({
    id: row[1]||"",
    nom: row[2]||"",
    rib: row[3]||"",
    grade: row[4]||"",
    tel: row[5]||"",
    discord: row[6]||"",
    gmail: row[8]||"",
    diplome: row[9]||"",
    entree: row[10]||"",
    sortie: row[11]||"",
    sanction: row[12]||"",
    retrait: row[13]||""
  })).filter(emp => emp.nom.trim() !== "" && emp.grade.trim() !== "");

  displayNavMenu();
  displayEmployeeList(allEmployees);
}

// üîπ Affiche le menu de navigation
function displayNavMenu() {
  const nav = document.getElementById("nav-menu");
  nav.innerHTML = "";
  categories.forEach(cat => {
    const btn = document.createElement("span");
    btn.className = "nav-btn";
    btn.textContent = cat.name;
    btn.addEventListener("click", () => filterCategory(cat.filter));
    nav.appendChild(btn);
  });
}

// üîπ Filtrer les employ√©s selon la cat√©gorie
function filterCategory(filterFn){
  const filtered = allEmployees.filter(filterFn);
  displayEmployeeList(filtered);
}

function displayEmployeeList(employees){
  const list = document.getElementById("employee-list");
  list.style.display = "flex";
  const details = document.getElementById("employee-details");
  details.style.display = "none";
  list.innerHTML = "";
  employees.forEach((emp, i) => {
    const card = document.createElement("div");
    card.className = "employee-card";
    card.innerHTML = `
      <div class="employee-name">${emp.nom}</div>
      <div class="employee-grade">${emp.grade}</div>
    `;
    card.addEventListener("click", () => showDetails(emp, employees));
    list.appendChild(card);
  });
}

function showDetails(emp, employeesList){
  currentIndex = employeesList.indexOf(emp);
  document.getElementById("employee-list").style.display = "none";
  const details = document.getElementById("employee-details");
  details.style.display = "block";
  details.innerHTML = `
    <h2>üë§ ${emp.nom}</h2>
    <table>
      <tr><td>ID Unique</td><td>${emp.id}</td></tr>
      <tr><td>RIB</td><td>${emp.rib}</td></tr>
      <tr><td>Grade</td><td>${emp.grade}</td></tr>
      <tr><td>Num√©ro de T√©l√©phone</td><td>${emp.tel}</td></tr>
      <tr><td>ID Discord</td><td>${emp.discord}</td></tr>
      <tr><td>Permis Gmail</td><td>${emp.gmail}</td></tr>
      <tr><td>üéì Dipl√¥me</td><td>${emp.diplome}</td></tr>
      <tr><td>Date d'entr√©e</td><td>${emp.entree}</td></tr>
      <tr><td>Date de sortie</td><td>${emp.sortie}</td></tr>
      <tr><td>Avertissement / Licenciement</td><td>${emp.sanction}</td></tr>
      <tr><td>Date de retrait</td><td>${emp.retrait}</td></tr>
    </table>
    <div style="text-align:center; margin-top:15px;">
      <span class="btn-nav" onclick="prevEmployee()">‚Üê Pr√©c√©dent</span>
      <span class="btn-nav" onclick="nextEmployee()">Suivant ‚Üí</span>
      <span class="btn-nav" onclick="backToList()">Retour √† la liste</span>
    </div>
  `;
}

// üîπ Navigation entre employ√©s
function prevEmployee(){
  if(currentIndex > 0) showDetails(window.allEmployees[currentIndex - 1], window.allEmployees);
}
function nextEmployee(){
  if(currentIndex < window.allEmployees.length - 1) showDetails(window.allEmployees[currentIndex + 1], window.allEmployees);
}
function backToList(){
  document.getElementById("employee-details").style.display = "none";
  document.getElementById("employee-list").style.display = "flex";
}

loadEmployees();
</script>
</body>
</html>
